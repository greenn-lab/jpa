# ê³ ê¸‰ ë§¤í•‘

## 1. ìƒì† ê´€ê³„ ë§¤í•‘

RDBMSì—ëŠ” ìƒì†ì´ë¼ëŠ” ê°œë…ì´ ì—†ì£ .  
ëŒ€ì‹ , "ìŠˆí¼ íƒ€ì… ì„œë¸Œ íƒ€ì… ê´€ê³„<sub>Super-Type Sub-Type Relationship</sub>" ë¼ëŠ” ëª¨ë¸ë§ ê¸°ë²•ì´ ìƒì† ê°œë…ê³¼ ìœ ì‚¬í•˜ë‹¤ë„¤ìš”.
![](07_001.svg)
ì™¼ìª½ì´ RDBMSì˜ ë…¼ë¦¬ ëª¨ë¸ì´ê³  ì˜¤ë¥¸ìª½ì€ Class-Diagram ì…ë‹ˆë‹¤.  
ê·¸ë¦¼ìœ¼ë¡œ ë³´ë‹ˆê¹Œ ì¢€ ìœ ì‚¬í•œë“¯ í•˜ë„¤ìš”.

ë…¼ë¦¬ ëª¨ë¸ì„ ë¬¼ë¦¬ ëª¨ë¸ë¡œ êµ¬í˜„í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ 3ê°€ì§€ë¥¼ ì†Œê°œí–ˆë„¤ìš”. ì•Œì•„ë´…ì‹œë‹¤.

### 1.1 ì¡°ì¸ ì „ëµ

![](07_002.svg)
ìš”ì†Œë“¤ì„ ê°ê°ì˜ í…Œì´ë¸”ë¡œ ë§Œë“¤ì£ . ì§ê´€ì ì´ë„¤ìš”. í•˜ì§€ë§Œ í…Œì´ë¸”ì´ ë°ì´í„°ì˜ íƒ€ì…ì„ êµ¬ë¶„ì§€ì–´ì£¼ì§€ëŠ” ëª»í•˜ë‹ˆê¹Œ `DTYPE` ì»¬ëŸ¼ì„ ì‚¬ìš©í•´ì•¼ ê² ë„¤ìš”.

```java
@Entity
@Inheritance(strategy = InherianceType.JOINED)
@DiscriminatorColumn(name = "DTYPE")
abstract class Item {
  @Id @GeneratedValue
  @Column(name = "ITEM_ID")
  private Long id;

  private String name;
  private Integer price;
  ...
}
```

```java
@Entity
@DiscrimatorValue("A")
class Album extends Item {
  private String artist;
  ...
}
```

```java
@Entity
@DiscriminatorValue("M")
class Movie extends Item {
  private String director;
  private String actor;
  ...
}
```

ë§Œì•½ ì„œë¸Œíƒ€ì… í…Œì´ë¸”ì˜ ê¸°ë³¸í‚¤(PK, FKê°€ ê±¸ë ¤ìˆëŠ”) ì»¬ëŸ¼ëª…ì´ ìŠˆí¼íƒ€ì…ê³¼ ë‹¤ë¥´ë‹¤ë©´ `@PrimaryKeyJoinColumn` ì„ ì“°ë©´ ëœëŒ€ìš”.

```java
@Entity
@DiscriminatorValue("B")
@PrimaryKeyJoinColumn(name = "BOOK_ID")
class Book extends Item {
  private String author;
  private String isbn;
  ...
}
```

---

"ì¡°ì¸ ì „ëµ"ì˜ ì¥ë‹¨ì ì„ ì •ë¦¬í•´ë³´ë©´,

- ì¥ì 
  - í…Œì´ë¸” ì •ê·œí™”
  - ì™¸ë˜ í‚¤ê°€ ê°€ì§„ "ì°¸ì¡° ë¬´ê²°ì„± ì œì•½ì¡°ê±´" í™œìš©
  - ì €ì¥ ê³µê°„ì˜ íš¨ìœ¨ì„± (ìš©ëŸ‰ ì‹ ê²½ì“°ëŠ” ì„¸ìƒì´ ì•„ë‹Œë“¯ í•œë°, ì¼ë‹¨ ì±…ì— ê·¸ë ‡ë‹¤í•˜ë‹ˆ...)
- ë‹¨ì 
  - ì¡°íšŒí•˜ë©´ join query ë•Œë¬¸ì— ì„±ëŠ¥ ì €í•˜
  - ì¡°íšŒ ì¿¼ë¦¬ì˜ ë³µì¡ë„
  - ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ 2ê°œì˜ í…Œì´ë¸”ì— INSERT

 <br>
 
### 1.2 ë‹¨ì¼ í…Œì´ë¸” ì „ëµ
![](07_003.svg)  
ë³„ê±° ì—†ì´ ê·¸ëƒ¥ í…Œì´ë¸”ì— ì—¬ëŸ¬ ì»¬ëŸ¼ì„ ë§Œë“¤ê³  êµ¬ê²¨ ë„£ë„¤ìš”.  
ìƒë‚¨ìê°™ë„¤, ë‚´ ìŠ¤íƒ€ì¼ì´ì•¼~ğŸ˜
```java
@Entity
@Inhieritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "DTYPE")
abstract class Item {
  @Id @GeneratedValue
  @Column(name = "ITEM_ID")
  private Long id

private String name;
private Integer price;
...
}

````
```java
@Entity
@DiscriminatorValue("A")
class Album extends Item {}
````

êµ¬ë¶„ ê°’ ë•Œë¬¸ì— ì–´ì¨Œë“  `abstract class` ë¥¼ ë§Œë“¤ê³ , `sub class` ë¥¼ ë§Œë“¤ì–´ì•¼ í•˜ëŠ” êµ°ìš”.  
`@DiscriminatorColumn` ì€ ê¼­ ì •ì˜ í•´ì•¼ë§Œ í•˜ê³ , `sub class` ì— `@DiscriminatorValue` ë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ìœ¼ë¡œ **"ì—”í‹°í‹° ì´ë¦„" ì´ ì‚¬ìš©** ëœëŒ€ìš”.

ì¥ë‹¨ì ì€,

- ì¥ì 
  - joinì´ ì—†ì–´ì„œ ì¼ë°˜ì ìœ¼ë¡œ ë¹ ë¥´ë‹¤ëŠ”êµ°ìš”.
  - ì¡°íšŒ ì¿¼ë¦¬ë„ ë‹¨ìˆœí•˜ê³ .
- ë‹¨ì 
  - ì„¸ë¶€ ì†ì„±ì„ ì €ì¥í•˜ëŠ” ì»¬ëŸ¼ë“¤ì´ nullable ì´ì–´ì•¼ë§Œ í•˜ê³ 
  - í•˜ë‚˜ì— ë‹¤ ë•Œë ¤ ë„£ìœ¼ë¯€ë¡œ ë°ì´í„°ê°€ í´ ê²½ìš°ì— ì˜¤íˆë ¤ ì„±ëŠ¥ ì €í•˜..ğŸ˜°

<br>

### 1.3 êµ¬í˜„ í´ë˜ìŠ¤ë§ˆë‹¤ í…Œì´ë¸” ì „ëµ

![](07_004.svg)  
ìƒì† êµ¬ì¡°ë¥¼ ë”°ë¥´ì§€ ì•Šê³  ê°œë³„ í•­ëª©ë³„ë¡œ ì—”í‹°í‹°ë¥¼ ë§Œë“¤ì–´ìš”.

```java
@Entity
@Inheritance(strategy = InheritanceType.TABLE_PER_CLASS)
abstract class Item {
  @Id @GeneratedValue
  @Column(name = "ITEM_ID")
  private Long id;

  private String name;
  private Integer price;
  ...
}
```

ê·¸ë˜ë„ ì—”í‹°í‹°ëŠ” ìƒì† êµ¬ì¡°ë¡œ í•´ì•¼ì£ . `@Discriminator~` ê°™ì€ê±´ ì“¸ëª¨ ì—†ê² ë„¤ìš”.

```java
@Entity
class Album extends Item {
  private String artist;
  ...
}
```

```java
@Entity
class Movie extends Item {
  private String director;
  private String actor;
  ...
}
```

ì±…ì—ì„œë„ ë¹„ì¶”ë¼ê³  í•˜ë„¤ìš”.ğŸ¤ª

- ì¥ì 
  - ì„œë¸Œ íƒ€ì…ì„ êµ¬ë¶„í•´ì„œ ì²˜ë¦¬í•  ë•Œ, íš¨ê³¼ì (?)
  - `not null` ì œì•½ì¡°ê±´ ì‚¬ìš© ê°€ëŠ¥
- ë‹¨ì 
  - í•­ëª©ë“¤ì„ ë™ì‹œì— ì¡°íšŒí•  ë•Œ ì„±ëŠ¥ ëŠë¦¼ (UNION SQL ì‚¬ìš©)
  - í†µí•©í•´ì„œ ì¿¼ë¦¬í•˜ê¸° í˜ë“¤ëŒ€ìš”.

## 2. @MappedSuperclass

`sub class` ì—ê²Œ `super class` ì˜ ë§¤í•‘ ì •ë³´ë§Œ ì£¼ê³  ì‹¶ë‹¤ë©´ ì´ê±¸ ì“°ë˜ìš”.

![](07_005.svg)  
`MEMBER` ì™€ `SELLER` ë¼ëŠ” ë¹„ìŠ·í•œ ì†ì„±ì˜ í…Œì´ë¸”ì´ ìˆì„ ë•Œ ì €ë ‡ê²Œ ì—”í‹°í‹°ë¥¼ ë§Œë“¤ê³ , ë‘ ì—”í‹°í‹°ì˜ ë™ì¼í•œ ì†ì„±ì„ `BaseEntity` ë¡œ ë§Œë“¤ì–´ì„œ ìƒì† ë°›ëŠ” êµ¬ì¡°ë¡œ ë§Œë“œë„¤ìš”.

```java
@MappedSuperclass
abstract class BaseEntity {
  @Id @GeneratedValue
  private Long id;
  private String name;
  ...
}
```

```java
@Entity
class Member extends BaseEntity {
  private String email;
  ...
}
```

<br>

`Super class` ì—ì„œ ë‚´ë ¤ì˜¨ ë§¤í•‘ì„ ì¬ì •ì˜ í•˜ë ¤ë©´ `@AttributeOverride(s)` ë¥¼ ì‚¬ìš©í•˜ê³ ìš”.

```java
@Entity
@AttributeOverrides({
  @AttributeOveride(name = "id", column = @Column(name = "MEMBER_ID"))
})
class Member extends BaseEntity {
  private String email;
}
```

ì—°ê´€ ê´€ê³„ë¥¼ ì¬ì •ì˜ í•˜ë ¤ë©´ `@AssociationOverride(s)` ë¥¼ ì‚¬ìš© í•œëŒ€ìš”. (ì±…ì— ì˜ˆì œê°€ ì—†ì–´ì„œ ì½”ë“œëŠ” ì—†ìŒ. íšì¼ì ì´ê³  ë‹¨í¸ì ì¸ ì¸ê°„ğŸ¥µ)

`@MappedSuperclass` íŠ¹ì§•ì€

- í…Œì´ë¸”ê³¼ ì§ì ‘ì ìœ¼ë¡œ ë§¤í•‘ë˜ëŠ”ê²Œ ì•„ë‹˜
- ì—”í‹°í‹°ê°€ ì•„ë‹ˆë¼ëŠ” ê±°~
- `abstract class` ë¡œ ì •ì˜í•˜ë¼ê³  ê¶Œì¥ (ë­, í•˜ê¸´ ë‹¨ë… í”Œë ˆì´ í•  ê²½ìš°ê°€ ì—†ì„ ë“¯)

<br>

## 3. ë³µí•© í‚¤ì™€ ì‹ë³„ ê´€ê³„ ë§¤í•‘

### 3.1 ì‹ë³„ ê´€ê³„ vs ë¹„ì‹ë³„ ê´€ê³„

**ì‹ë³„ê´€ê³„** ë€, ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ë‚´ë ¤ ë°›ì•„ì„œ **_ìì‹ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©_** í•˜ëŠ” ê´€ê³„  
![](07_006.svg)

**ë¹„ì‹ë³„ ê´€ê³„** ë€, ë¶€ëª¨ í…Œì´ë¸”ì—ì„œ ê¸°ë³¸ í‚¤ë¥¼ ë‚´ë ¤ ë°›ì§€ë§Œ **_ìì‹ í…Œì´ë¸”ì—ì„œ ì™¸ë˜ í‚¤_** ë¡œë§Œ ì‚¬ìš©í•˜ëŠ” ê´€ê³„  
![](07_007.svg)  
**í•„ìˆ˜ì  ë¹„ì‹ë³„ ê´€ê³„** ëŠ” ì™¸ë˜ í‚¤ì— NULLì„ í—ˆìš©í•˜ì§€ ì•Šì•„ ê¼­ ê´€ê³„ë¥¼ ë§ºì–´ì•¼ğŸ’• í•˜ê³ , **ì„ íƒì  ë¹„ì‹ë³„ ê´€ê³„** ëŠ” ~~ì„œë¡œ ë§¤ë ¥ì„ ëœ ëŠê¼ˆëŠ”ì§€~~ ê´€ê³„ë¥¼ ë§ºì„ì§€ ë§ì§€...

### 3.2 ë³µí•© í‚¤: ë¹„ì‹ë³„ ê´€ê³„ ë§¤í•‘

![](07_008.svg)

```java
@Entity
@IdClass(ParentId.class)
class Parent {
  @Id
  @Column(name = "PARENT_ID1")
  private Long id1;

  @Id
  @Column(name = "PARENT_ID2")
  private Long id2;

  private String name;
  ...
}
```

ë³µí•© í‚¤ë¡œ êµ¬ì„±ëœ `Parent` ì—”í‹°í‹°ëŠ” `@IdClass` ë¥¼ ì‚¬ìš©í–ˆë„¤ìš”.

```java
@EqualsAndHashCode
public class ParentId implements Serialization {
  private Long id1;
  private Long id2;
  ...
}
```

ê¸°ì–µë‚˜ì‹œë‚˜ìš”? `@IdClass` ëŠ” `Serialization`, `equals()`, `hashCode()` ì„ êµ¬í˜„í•´ì•¼ í•˜ê³ , ê¸°ë³¸ ìƒì„±ì ìˆì–´ì•¼í•˜ê³  ë“±ë“±..
ì•„ì°¸, ì œì¼ ì¤‘ìš”í•œ ê±°.  
`@IdClass` ì˜ í•„ë“œ ëª…ì¹­ê³¼ ì‚¬ìš©í•˜ëŠ” ì—”í‹°í‹°ì˜ `@Id` í•„ë“œ ëª…ì¹­ê³¼ ê°™ì•„ì•¼ í•œë‹¤ëŠ” ê±°.
ì‹¤ì œë¡œ ì—”í‹°í‹°ë¥¼ ì €ì¥í•  ë•ŒëŠ”

```java
Parent p = new Parent();
p.setId("myId1"); // ì‹ë³„ì1
p.setId("myId2"); // ì‹ë³„ì2
p.setName("lullullalla");
em.perist(p);
```

ì´ë ‡ê²Œë§Œ í•´ë„ ì €ì¥ë ë•ŒëŠ” `ParentId.class` ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ë¨¼ì € ìƒì„±ë˜ê³ , ê±°ê¸°ì„œ ìƒì„±ëœ ì‹ë³„ìë¥¼ ê°€ì§€ê³  ì €ì¥ì´ ë˜ëŠ” ë°©ì‹ì´ë¼ë‹ˆ, ë˜‘ë˜‘í•˜ë„¤~

```java
@Entity
class Child {
  @Id
  private Long id;

  @ManyToOne
  @JoinColumns({
    @JoinColumn(name = "PARENT_ID1", referencedColumnName = "PARENT_ID1"),
    @JoinColumn(name = "PARENT_ID2", referencedColumnName = "PARENT_ID2")
  })
  private Parent parent;
  ...
}
```

ìì‹ í´ë˜ìŠ¤ëŠ” ì—”í‹°í‹°ë¥¼ ì´ë ‡ê²Œ êµ¬ì„±í•  ìˆ˜ ìˆëŒ€ìš”.  
ë¬¼ë¡  `@JoinColumn` ì˜ `name` ê³¼ `referencedColumnName` ëª…ì¹­ì´ ê°™ì„ ë•ŒëŠ” ìƒëµí•  ìˆ˜ ìˆëŒ€ìš”.

<br>

`@IdClass` ê°€ RDBMSì— ë§ì¶˜ ë°©ë²•ì´ë¼ë©´ @EmbeddedId ëŠ” ê°ì²´ ì§€í–¥ì ì¸ ë°©ë²•ì´ë˜ìš”.

```java
@Entity
class Parent {
  @EmbeddedId
  private ParentId id;
  private String name;
  ...
}
```

ì´ë ‡ê²Œ Parent ì—”í‹°í‹°ë¥¼ ë§Œë“¤ê³ ,

```java
@Embeddable
@EqualsAndHashCode
class ParentId implements Serializable {
  @Column(name = "PARENT_ID1")
  private Long id1;

  @Column(name = "PARENT_ID2")
  private Long id2;
  ...
}
```

`@IdClass` ë‘ì€ ë‹¤ë¥´ê²Œ í•„ë“œì— ê¸°ë³¸ í‚¤ ì»¬ëŸ¼ì„ ë§¤í•‘í–ˆë„¤ìš”. ì´ê²Œ ì¢€ ì¢‹ì•„ë³´ì´ë„¤ìš”, ì €ëŠ”.  
ì‘ì„± ê·œì¹™ì€ `@IdClass` ì™€ ê°™ì´

- ê¸°ë³¸ ìƒì„±ì
- Serialization êµ¬í˜„
- equals, hashCode Override
- class ì ‘ê·¼ì´ public

<br>

### 3.3 ë³µí•© í‚¤: ì‹ë³„ ê´€ê³„ ë§¤í•‘

![](07_009.svg)  
ì´ê±¸ ìš°ì„  `@IdClass` ë¡œ ì—”í‹°í‹°ë¥¼ ì‘ì„±í•´ ë³´ë©´,

```java
@Entity
class Parent {
  @Id
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;
  ...
}
```

```java
@Entity
@IdClass(ChildId.class)
class Child {
  @Id
  @ManyToOne
  @JoinColumn(name = "PARENT_ID")
  private Parent parent;

  @Id
  @Column(name = "CHILD_ID")
  private Long childId;

  private String name;
  ...
}
```

```java
@EqualsAndHashCode
public class ChildId implements Serializable {
  private Long parent; // í•„ë“œ ì´ë¦„ì´ ê°™ì•„ì•¼ í•´ìš”!
  private Long childId;
  ...
}
```

```java
@Entity
@IdClass(GrandChildId.class)
class GrandChild {
  @Id
  @ManyToOne
  @JoinColumns({
    @JoinColumn(name = "PARENT_ID"),
    @JoinColumn(name = "CHILD_ID")
  })
  private Child child;

  @Id
  @Column(name = "GRAND_CHILD_ID")
  private Long grandChildId;

  private String name;
  ...
}
```

```java
public class GrandChildId implements Serializable {
  private ChildId child;
  priate Long grandChildId;
  ...
}
```

ë§‰ìƒ í•´ë³´ë‹ˆê¹ ìƒê°ì„ ì¢€ í•´ì•¼í•˜ë„¤ìš”.  
ì´ë²ˆì—ëŠ” `@EmbeddedId` ë¥¼ ì‚¬ìš©í•´ì„œ ì—”í‹°í‹°ë¥¼ êµ¬ì„±í•´ë´ìš”. ì „ ì´ê²Œ ë” ë§˜ì— ë“¤ì—ˆëŠ”ë°. Parent ì—”í‹°í‹°ëŠ” ë™ì¼ í•˜ê³ ìš”.

```java
@Embeddable
public class ChildId implements Serializable {
  @Id @Column(name = "PARENT_ID")
  private Long parentId;

  @Id @Column(name = "CHILD_ID")
  private Long childId;
  ...
}
```

```java
@Entity
class Child {
  @EmbeddedId
  private ChildId id;

  @MapsId("parentId")
  @ManyToOne
  @JoinColumn(name = "PARENT_ID")
  public Parent parent;

  private String name;
  ...
}
```

```java
@Embeddable
public GrandChildId implements Serializable {
  private ChildId childId; // @MapsId ë¡œ ë§¤í•‘??

  @Id @Column(name = "GRAND_CHILD_ID")
  private Long grandChildId;
  ...
}
```

```java
@Entity
class GrandChild {
  @EmbeddedId
  private GrandChildId id;

  @MapsId("childId")
  @ManyToOne
  @JoinColumns({
    @JoinColumn(name = "PARENT_ID"),
    @JoinColumn(name = "CHILD_ID")
  })
  private Child child;

  private String name;
  ...
}
```

`@EmbeddedId` ëŠ” ê·¸ëƒ¥ ë˜ëŠ”ê²Œ ì•„ë‹ˆì—ˆë‹¤. `@Id` ëŒ€ì‹ í•´ì„œ `@MapsId(...)` ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜êµ°ìš”.

<br>

### 3.4 ë¹„ì‹ë³„ ê´€ê³„ë¡œ êµ¬í˜„

![](07_010.svg)  
ì´ëŸ° ë¹„ì‹ë³„ ê´€ê³„ë¥¼ ì—”í‹°í‹°ë¡œ ë§Œë“¤ì–´ ë´…ì‹œë‹¤.

```java
@Entity
class Parent {
  @Id @Column(name = "PARENT_ID")
  private Long id;

  private String name;
  ...
}
```

```java
@Entity
class Child {
  @Id @Column(name = "CHILD_ID")
  private Long id;

  @ManyToOne
  @JoinColumn(name = "PARENT_ID")
  private Parent parent;

  private String name;
  ...
}
```

```java
class GrandChild {
  @Id @Column(name = "GRAND_CHILD_ID")
  private Long id;

  @ManyToOne
  @JoinColumn(name = "CHILD_ID")
  private Child child;

  private String name;
  ...
}
```

ì´ê±´ ê°„ë‹¨í•˜ë„¤ìš”.

<br>

### 3.5 ì¼ëŒ€ì¼ ì‹ë³„ ê´€ê³„

![](07_011.svg)  
ì¼ëŒ€ì¼ ì‹ë³„ ê´€ê³„ëŠ” íŠ¹ë³„í•˜ëŒ€ìš”.

```java
@Entity
class Board {
  @Id @GeneratedValue
  @Column(name = "BOARD_ID")
  private Long id;

  private String title;

  @OneToOne(mappedBy = "board")
  private BoardDetail detail;
}
```

```java
@Entity
class BoardDetail {
  @Id
  private Long id;

  private String content;

  @MapsId
  @OneToOne
  @JoinColumn(name = "BOARD_ID")
  private Board board;
}
```

ì´ë ‡ê²Œ ë§¤í•‘í•œ ì—”í‹°í‹°ë¥¼ ì €ì¥í•˜ë ¤ë©´,

```java
public void save() {
  Board board = new Board();
  board.setTitle("t-i-t-l-e");
  em.persit(board);

  BoardDetail detail = new BoardDetail();
  detail.setContent("c-o-n-t-e-n-t");
  detail.setBoard(board);
  em.persist(detail);
}
```

ì‹ë³„ê³¼ ë¹„ì‹ë³„ì˜ ì—”í‹°í‹° ë§¤í•‘ì„ ì •ë¦¬ í•˜ë©´ì„œ ì¥ë‹¨ì ì„ ëª‡ê°€ì§€ ì†Œê°œ í–ˆëŠ”ë°, ìš”ì•½í•˜ë©´ **_ë¹„ì‹ë³„ ê´€ê³„ë¥¼ ì‚¬ìš©í•˜ê³  ê¸°ë³¸ í‚¤ëŠ” Long íƒ€ì…(ìˆ«ì)ì˜ ëŒ€ë¦¬í‚¤ë¥¼ ì‚¬ìš©_** í•˜ë€ ë§ì”€!

## 4. ì¡°ì¸í…Œì´ë¸”

![](07_012.svg)

1:1 Join Table ë§¤í•‘í•´ë´ìš”.

```java
@Entity
class Parent {
  @Id @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;

  @OneToOne
  @JoinTable(
    name = "PARENT_CHILD",
    joinColumns = @JoinColumn(name = "PARENT_ID"),
    inverseJoinColumns = @JoinColumn(name = "CHILD_ID")
  )
  private Child child;
  ...
}
```

```java
@Entity
class Child {
  @Id @GeneratedValue
  @Column(name = "CHILD_ID")
  private Long id;
  private String name;
  ...
  /**
   * for bidirectional
  @OneToOne(mappedBy = "child")
  private Parent parent;
  */
}
```

### 4.2 ì¼ëŒ€ë‹¤ ì¡°ì¸ í…Œì´ë¸”

![](07_013.svg)

```java
@Entity
class Child {
  @Id @GeneratedValue
  @Column(name = "CHILD_ID")
  private Long id;
  private String name;
  ...
}
```

```java
@Entity
class Parent {
  @Id @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;

  @OneToMany
  @JoinTable(
    name = "PARENT_CHILD",
    joinColumns = @JoinColumn(name = "PARENT_ID"),
    inverseJoinColumns = @JoinColumn(name = "CHILD_ID")
  )
  private List<Child> children = new ArrayList<>();
  ...
}
```

ì€ê·¼ í—·ê°ˆë¦¬ë„¤ìš”, `Child` ì—”í‹°í‹°ì—ì„œ ë­”ê°€ë¥¼ í•´ì¤˜ì•¼ í•˜ë‚˜ ì‹¶ì—ˆëŠ”ë°...

### 4.3 ë‹¤ëŒ€ì¼ ì¡°ì¸ í…Œì´ë¸”

ì¼ëŒ€ë‹¤ì˜ ë°˜ëŒ€ ë°©í–¥í–¥ì¸ê±°ì£ . ë‹¤ëŒ€ì¼, ì¼ëŒ€ë‹¤ ì–‘ë°©í–¥ ê´€ê³„ë¡œ ë§¤í•‘í•´ë³´ì¬ìš”.

```java
@Entity
class Child {
  @Id @GeneratedValue
  @Column(name = "CHILD_ID")
  private Long id;
  private String name;

  @ManyToOne(optional = false) // What is optional?!
  @JoinTable(
    name = "PARENT_CHILD",
    joinColumns = @JoinColumn(name = "CHILD_ID"),
    inverseJoinColumns = @JoinColumn(name = "PARENT_ID")
  )
  private Parent parent;
}
```

```java
@Entity
class Parent {
  @Id @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;

  @OneToMany(mappedBy = "parent")
  private List<Child> children = new ArrayList<>();
  ...
}
```

### 4.4 ë‹¤ëŒ€ë‹¤ ì¡°ì¸ í…Œì´ë¸”

![](07_014.svg)

```java
@Entity
class Parent {
  @Id @GeneratedValue
  @Column(name = "PARENT_ID")
  private Long id;
  private String name;

  @ManyToMany
  @JoinTable(
    name = "PARENT_CHILD",
    joinColumns = @JoinColumn(name = "PARENT_ID"),
    inverseJoinColumns = @JoinColumn(name = "CHILD_ID")
  )
  private List<Child> children = new ArrayList<>();
  ...
}
```

```java
@Entity
class Child {
  @Id @GeneratedValue
  @Column(name = "CHILD_ID")
  private Long id;
  private String name;

  /**
   * ì œê°€ ê·¸ëƒ¥ í•œë²ˆ í•´ë´¤ì–´ìš”. ì–‘ë°©í–¥ì„ ì“¸ì¼ì´ ì—†ëŒ€ë„, ì´ëŸ°ì‹ìœ¼ë¡œ í•˜ë©´ ë ê¹Œìš”?
  @ManyToMany(mappedBy = "children")
  private List<Parent> parents = new ArrayList<>();
   */
  ...
}
```

<br>

### 5. ì—”í‹°í‹° í•˜ë‚˜ì— ì—¬ëŸ¬ í…Œì´ë¸” ë§¤í•‘

`@SecondaryTable` ì„ ì‚¬ìš©í•˜ë©´ í•˜ë‚˜ì˜ ì—”í‹°í‹°ì— ì—¬ëŸ¬ í…Œì´ë¸”ì„ ë§¤í•‘í•  ìˆ˜ ìˆëŒ€ìš”.

![](07_015.svg)

```java
@Entity
@Table(name = "BOARD")
@SecondaryTable(
  name = "BOARD_DETAIL",
  pkJoinColumns = @PrimaryKeyJoinColumn(name = "BOARD_DETAIL_ID")
)
class Board {
  @Id @GeneratedValue
  @Column(name = "BOARD_ID")
  private Long id;
  private String title;

  @Column(table = "BOARD_DETAIL")
  private String content;
  ...
}
```

ìƒˆë¡œìš´ annotation ì´ ë“±ì¥í–ˆì§€ë§Œ ì†ì„± ëª…ì¹­ë“¤ì´ ì§ê´€ì ì´ë¼ì„œ ë”°ë¡œ ì„¤ëª…í•˜ì§€ ì•Šì•„ë„ ì´í•´ ë  ê²ƒ ê°™ë„¤ìš”.  
ë” ë§ì€ í…Œì´ë¸”ì„ ë§¤í•‘í•˜ë ¤ë©´ `@SecondaryTables` ë„ ìˆëŒ€ìš”.
